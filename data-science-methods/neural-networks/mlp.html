

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MLP (Multilayer Perceptron) &#8212; CaloRICH AI</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/quantecon-book-theme.0127a672561e20f571b5425514463df1.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />


    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/quantecon-book-theme.ef2ef6c3e8da75e1e736fb5fce08cde6.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'data-science-methods/neural-networks/mlp';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MLP Quantile Regression" href="mlp-quantile.html" />
    <link rel="prev" title="Neural Networks" href="index.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Crystal Geng, Daniel Merigo, Kelvin Wong, Peng Zhang" />
<meta name="keywords" content="calorich, triumf, na62" />
<meta name="description" content="MLP (Multilayer Perceptron)  Why did we choose this model  A multilayer perceptron (MLP) is a classic fully connected feedforward neural network. In our project" />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="MLP (Multilayer Perceptron)"/>
<meta name="twitter:description" content="MLP (Multilayer Perceptron)  Why did we choose this model  A multilayer perceptron (MLP) is a classic fully connected feedforward neural network. In our project">
<meta name="twitter:image" content="">

<!-- Opengraph tags -->
<meta property="og:title" content="MLP (Multilayer Perceptron)" />
<meta property="og:type" content="website" />
<meta property="og:url" content="None" />
<meta property="og:image" content="" />
<meta property="og:description" content="MLP (Multilayer Perceptron)  Why did we choose this model  A multilayer perceptron (MLP) is a classic fully connected feedforward neural network. In our project" />
<meta property="og:site_name" content="CaloRICH AI" />

<link rel="icon" href="../../_static/favicon.svg" type="image/svg+xml" />
<link rel="apple-touch-icon" href="../../_static/apple-touch-icon.png" />

<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=data-science-methods/neural-networks/mlp>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-did-we-choose-this-model">Why did we choose this model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features-and-model-structure">Features and model structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-process-and-results">Training process and results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
                            <p class="logo">
                                
                            </p>
                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="../../index.html">CaloRICH AI</a></p>

                        <p class="qe-page__header-subheading">MLP (Multilayer Perceptron)</p>

                    </div>

                    <p class="qe-page__header-authors">Crystal Geng, Daniel Merigo, Kelvin Wong, Peng Zhang</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section id="mlp-multilayer-perceptron">
<h1>MLP (Multilayer Perceptron)<a class="headerlink" href="#mlp-multilayer-perceptron" title="Permalink to this headline">#</a></h1>
<section id="why-did-we-choose-this-model">
<h2>Why did we choose this model<a class="headerlink" href="#why-did-we-choose-this-model" title="Permalink to this headline">#</a></h2>
<p>A multilayer perceptron (MLP) is a classic fully connected feedforward neural network. In our project for the regression problem, by designing appropriate number of hidden layers and incorporating a non-linear activation function, the model is expected to capture more complex linear and non-linear relationships between input features (regressors) and the target in the training dataset, and output predictions for the unseen testing dataset. MLP is easy to implement in the PyTorch <span id="id1">[<a class="reference internal" href="../../references.html#id14" title="Pytorch documentation. URL: https://pytorch.org/docs/stable/index.html# (visited on 2023-06-24)."><em>PyTorch Documentation</em>, n.d.</a>]</span> framework. It provides us with the extensive flexibility to custom design deep learning structures, define particular loss functions, or add more functionalities to our modeling. For example, we have also implemented a quantile regression based on the MLP architecture.</p>
</section>
<section id="features-and-model-structure">
<h2>Features and model structure<a class="headerlink" href="#features-and-model-structure" title="Permalink to this headline">#</a></h2>
<p>The MLP model has taken all <a class="reference external" href="https://triumf-mds-capstone2023.github.io/project/data/engineered-features.html">18 engineered features</a> as the inputs, the theoretical ring radius as the target, to predict the ring radius for each event.</p>
<p>After a number of experiments, we have selected a MLP model with 4 hidden layers. The hidden size is gradually decreased from 1024 to 12, and the <a class="reference external" href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">ReLU activation function</a> has been used in each hidden layer.</p>
</section>
<section id="training-process-and-results">
<h2>Training process and results<a class="headerlink" href="#training-process-and-results" title="Permalink to this headline">#</a></h2>
<p>To avoid possible bias from two particles, the model has been trained on randomly split 75% of muon events, then tested on the rest of muon events and all pion events. Based on the PyTorch framework, we have developed the training and validation data loaders, the custom defined trainer, used standard <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.MSELoss.html">MSELoss function</a> and Adam optimizer <span id="id2">[<a class="reference internal" href="../../references.html#id13" title="Diederik P. Kingma and Jimmy Ba. Adam: a method for stochastic optimization. 2017. arXiv:1412.6980.">Kingma and Ba, 2017</a>]</span> to train the MLP model.</p>
<p>In addition, before feeding features into the model, the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a> has been applied to rescale the inputs considering unscaled inputs could result in exploding gradients during the learning process.</p>
<p>After the training completed, we tested the regression performance on the test data. Between the predicted ring radius and the theoretical values, the R2 score was 0.934 and the MAE (Mean Absolute Error) was 1.92. Compared to the result of the XGBRegressor approach (R2 was 0.94), the accuracy of the MLP model was slightly lower.</p>
<p>We have also performed residual analysis for the MLP model. As shown in <a class="reference internal" href="#mlp-residual-plot"><span class="std std-ref">Fig. 5</span></a>, the similar patterns were observed compared to the residual plot from the XGBRegressor. The result confirms the bias analysis in the previous section.</p>
<figure class="align-default" id="mlp-residual-plot">
<img alt="../../_images/mlp_residual_plot.png" src="../../_images/mlp_residual_plot.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Residual plot residuals vs. calculated ring radius for MLP model</span><a class="headerlink" href="#mlp-residual-plot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">#</a></h2>
<p>From the result comparison between XGBRegressor and the MLP model, we can see the deep learning architecture (MLP) did not improve the regression performance. Considering the longer training time, and the extra pre-processing steps including normalisation and tensor conversion required for the MLP modeling, we think the XGBRegressor is the better approach for the regression purpose.</p>
<p>One of the advantages of deep learning methods is to rely on the complex networks to perform feature engineering and feature extraction. In our case, we feed the MLP model with explicitly engineered features rather than the raw data (coordinates of hits for each event). It is possible that the method we have used in this section did not reach the full potential of the deep learning. Therefore, we are exploring other neural network architectures that can be directly trained with the raw hit coordinates.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./data-science-methods/neural-networks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p>Copyright &copy; 2023 Crystal Geng, Daniel Merigo, Kelvin Wong, Peng Zhang</p>

                    <p><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="https://licensebuttons.net/l/by-nc-nd/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/"></a>Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International</a>.</p>

                    <p>Powered by <a href="https://jupyterbook.org/" target="_blank" rel="noreferer nofollow">Jupyter Book</a>. Theme forked from <a href="https://github.com/QuantEcon/quantecon-book-theme" target="_blank" rel="noreferer nofollow">quantecon-book-theme</a>.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive persistent" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../preface/executive_summary.html">
   Executive Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../preface/introduction.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/raw-data.html">
   Raw Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/eda.html">
   Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/preprocessing.html">
   Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../data/engineered-features.html">
   Engineered Features
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science Methods
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../regressor/index.html">
   Regressor
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label class="toctree-toggle" for="toctree-checkbox-1">
   <i class="fa-solid fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../regressor/xgbregressor.html">
     XGBoost Regressor
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children active">
  <a class="reference internal" href="index.html">
   Neural Networks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label class="toctree-toggle" for="toctree-checkbox-2">
   <i class="fa-solid fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active active">
    <a class="current reference internal" href="#">
     MLP (Multilayer Perceptron)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mlp-quantile.html">
     MLP Quantile Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pointnet.html">
     PointNet
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../best-performing-model/index.html">
   Best Performing Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Conclusion
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../conclusion.html">
   Conclusion
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../references.html">
   References
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="../../index.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://triumf-mds-capstone2023.github.io/project" title=""><span class="show-for-sr">CaloRICH AI</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="../../search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/TRIUMF-MDS-Capstone2023/project/blob/main/docs/final/website/data-science-methods/neural-networks/mlp.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>

    </div> <!-- .wrapper-->
  </body>
</html>